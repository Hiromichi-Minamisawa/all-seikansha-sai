<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>å‡ºé¡Œç®¡ç†</title>
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: white;
      padding: 2rem;
    }
    .question-list {
      max-height: 300px;
      overflow-y: auto;
      margin-bottom: 1rem;
    }
    .question-box {
      background: #333;
      padding: 1rem;
      margin-bottom: 0.5rem;
      cursor: pointer;
      border-left: 5px solid transparent;
    }
    .question-box.selected {
      border-left-color: gold;
    }
    button {
      padding: 0.5rem 1rem;
      margin: 0.5rem;
      font-size: 1rem;
    }
    audio {
      display: none;
    }
  </style>
</head>
<body>
  <h1>ã‚¯ã‚¤ã‚ºå‡ºé¡Œç®¡ç†</h1>

  <div class="question-list" id="questionList"></div>

  <button id="sendBtn">å‡ºé¡Œã™ã‚‹</button>
  <button id="showCorrectBtn">æ­£è§£ã‚’è¡¨ç¤º</button>
  <button id="resetBtn">å›ç­”ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
  <button id="showVotesBtn">ã‚¢ãƒ³ã‚µãƒ¼ãƒã‚§ãƒƒã‚¯</button>

  <div style="margin-top: 1rem;">
    <button onclick="playSE('se1')">ğŸµ ãƒ”ãƒ³ãƒãƒ³</button>
    <button onclick="playSE('se2')">ğŸ’¥ ãƒ–ãƒ¼</button>
  </div>

  <audio id="se1" src="pinpon.mp3"></audio>
  <audio id="se2" src="boo.mp3"></audio>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getDatabase, ref, set, update, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAi5sKHLYDr_h4uq0AmLXTDD_hevG3kOJQ",
      authDomain: "all-seikanshasai.firebaseapp.com",
      databaseURL: "https://all-seikanshasai-default-rtdb.firebaseio.com",
      projectId: "all-seikanshasai",
      storageBucket: "all-seikanshasai.appspot.com",
      messagingSenderId: "24572064606",
      appId: "1:24572064606:web:a7f94b0561333f272055cf"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const questionList = [
      {
        question: "ä¸–ç•Œã§ä¸€ç•ªé«˜ã„å±±ã¯ï¼Ÿ",
        choices: ["ã‚­ãƒªãƒãƒ³ã‚¸ãƒ£ãƒ­", "ãƒ¢ãƒ³ãƒ–ãƒ©ãƒ³", "ã‚¨ãƒ™ãƒ¬ã‚¹ãƒˆ", "å¯Œå£«å±±"],
        correct: 2
      },
      {
        question: "æ—¥æœ¬ã®é¦–éƒ½ã¯ã©ã“ï¼Ÿ",
        choices: ["å¤§é˜ª", "åå¤å±‹", "äº¬éƒ½", "æ±äº¬"],
        correct: 3
      },
      {
        question: "2+2ã¯ï¼Ÿ",
        choices: ["1", "2", "3", "4"],
        correct: 3
      }
    ];

    const listEl = document.getElementById("questionList");
    let selectedIndex = null;

    questionList.forEach((q, index) => {
      const div = document.createElement("div");
      div.className = "question-box";
      div.innerText = `${index + 1}. ${q.question}`;
      div.onclick = () => {
        document.querySelectorAll(".question-box").forEach(el => el.classList.remove("selected"));
        div.classList.add("selected");
        selectedIndex = index;
      };
      listEl.appendChild(div);
    });

    document.getElementById("sendBtn").onclick = async () => {
      if (selectedIndex === null) {
        alert("å•é¡Œã‚’é¸ã‚“ã§ãã ã•ã„");
        return;
      }
      const q = questionList[selectedIndex];
      const questionRef = ref(db, "currentQuestion");
      await set(questionRef, {
        ...q,
        showAnswer: false,
        startTime: Date.now()
      });
      await set(ref(db, "showCorrect"), false);
      await set(ref(db, "answers"), {});
    };

    document.getElementById("showCorrectBtn").onclick = () => {
      set(ref(db, "showCorrect"), true);
    };

    document.getElementById("resetBtn").onclick = () => {
      set(ref(db, "answers"), {});
      set(ref(db, "showCorrect"), false);
    };
    
    document.getElementById("showVotesBtn").onclick = () => {
 ã€€ set(ref(db, "showVotes"), true);
ã€€ã€€};

    window.playSE = function(id) {
      const audio = document.getElementById(id);
      audio.currentTime = 0;
      audio.play();
    };
  </script>
</body>
</html>
